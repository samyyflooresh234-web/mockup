<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mockup Boletos</title>

<style>
body{
  margin:0;
  padding:20px;
  font-family:Arial, sans-serif;
  text-align:center;
  background:#fff;
}

/* CONTENEDOR PRINCIPAL */
#export-area{
  margin:auto;
  position:relative;
  background:white;
  overflow:hidden;
  border-radius:20px;
}

/* FORMATOS */
.square{ width:1080px; height:1080px; max-width:90vw; max-height:90vw; }
.story{ width:1080px; height:1920px; max-width:90vw; max-height:160vw; }
.wide{ width:1080px; height:341px; max-width:90vw; }

/* FONDO */
#background{
  position:absolute;
  inset:0;
  background-size:cover;
  background-position:center;
  z-index:0;
}

/* CONTENEDOR BOLETOS */
#mockup{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:2;
}

.stack{
  position:relative;
  width:70%;
}

/* BOLETO */
.ticket{
  position:absolute;
  width:100%;
  height:140px;
  border-radius:14px;
  background:white;
  overflow:hidden;
  box-shadow:
    0 18px 40px rgba(0,0,0,.28),
    0 6px 14px rgba(0,0,0,.22);
}

.ticket img{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* POSICIÓN VERTICAL BASE */
.ticket:nth-child(1){ top:0; }
.ticket:nth-child(2){ top:100px; }
.ticket:nth-child(3){ top:200px; }
.ticket:nth-child(4){ top:300px; }
.ticket:nth-child(5){ top:400px; }

.controls{
  margin-bottom:20px;
}

.slider-group{
  margin:8px 0;
}

button{
  margin-top:15px;
  padding:12px 18px;
  background:black;
  color:white;
  border:none;
  border-radius:6px;
}
</style>
</head>

<body>

<div class="controls">
  <p><b>Formato</b></p>
  <select onchange="setFormat(this.value)">
    <option value="square">1:1</option>
    <option value="story">Historia Instagram</option>
    <option value="wide">19:6</option>
  </select>

  <p>Boletos (máx 5)</p>
  <input type="file" accept="image/*" multiple onchange="loadTickets(event)">

  <p>Fondo</p>
  <input type="file" accept="image/*" onchange="loadBackground(event)">
</div>

<!-- SLIDERS INDIVIDUALES -->
<div id="sliders"></div>

<div id="export-area" class="square">
  <div id="background"></div>
  <div id="mockup">
    <div class="stack" id="stack"></div>
  </div>
</div>

<button onclick="exportImage()">EXPORTAR IMAGEN</button>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
const stack = document.getElementById("stack");
const bg = document.getElementById("background");
const sliders = document.getElementById("sliders");
const exportArea = document.getElementById("export-area");

function setFormat(f){
  exportArea.className = "";
  exportArea.classList.add(f);
}

function loadBackground(e){
  const r = new FileReader();
  r.onload = ev => bg.style.backgroundImage = `url(${ev.target.result})`;
  r.readAsDataURL(e.target.files[0]);
}

function loadTickets(e){
  stack.innerHTML="";
  sliders.innerHTML="";

  [...e.target.files].slice(0,5).forEach((f,i)=>{
    const r = new FileReader();
    r.onload = ev=>{
      const t = document.createElement("div");
      t.className="ticket";
      t.style.transform = "translateX(0px)";
      t.innerHTML = `<img src="${ev.target.result}">`;
      stack.appendChild(t);

      // Slider individual
      const sg = document.createElement("div");
      sg.className="slider-group";
      sg.innerHTML = `
        <label>Boleto ${i+1} (X)</label><br>
        <input type="range" min="-150" max="150" value="0"
        oninput="moveTicket(${i}, this.value)">
      `;
      sliders.appendChild(sg);
    };
    r.readAsDataURL(f);
  });
}

function moveTicket(index, val){
  const t = stack.children[index];
  t.style.transform = `translateX(${val}px)`;
}

/* EXPORT REAL iOS */
function exportImage(){
  html2canvas(exportArea,{
    scale:3,
    backgroundColor:"#ffffff"
  }).then(canvas=>{
    document.body.innerHTML="";
    const img=document.createElement("img");
    img.src=canvas.toDataURL("image/png");
    img.style.width="100%";
    document.body.appendChild(img);
  });
}
</script>

</body>
</html>
